<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DMAP ë¼ì´ë¸ŒëŸ¬ë¦¬ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            padding: 20px;
            max-width: 600px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        .status {
            background: white;
            padding: 20px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .pending { color: #ff9800; }
        h1 { color: #2196f3; }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
        }
        button:active {
            background: #1976d2;
        }
        #log {
            background: #333;
            color: #0f0;
            padding: 15px;
            border-radius: 6px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <h1>ğŸ”§ DMAP ë¼ì´ë¸ŒëŸ¬ë¦¬ í…ŒìŠ¤íŠ¸</h1>
    
    <div class="status">
        <h3>ë„¤íŠ¸ì›Œí¬ ìƒíƒœ</h3>
        <p id="networkStatus" class="pending">í™•ì¸ ì¤‘...</p>
    </div>
    
    <div class="status">
        <h3>ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© ìƒíƒœ</h3>
        <p id="threeStatus" class="pending">â³ Three.js: ë¡œë”© ì¤‘...</p>
        <p id="dxfStatus" class="pending">â³ Three-DXF: ë¡œë”© ì¤‘...</p>
    </div>
    
    <div class="status">
        <h3>CDN í…ŒìŠ¤íŠ¸</h3>
        <button onclick="testCDN('https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js')">Three.js (jsdelivr)</button>
        <button onclick="testCDN('https://cdn.jsdelivr.net/npm/three-dxf@3.3.2/dist/three-dxf.umd.js')">Three-DXF (jsdelivr)</button>
        <button onclick="testCDN('https://unpkg.com/three@0.150.1/build/three.min.js')">Three.js (unpkg)</button>
    </div>
    
    <div class="status">
        <h3>ì•¡ì…˜</h3>
        <button onclick="location.reload()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
        <button onclick="clearCache()">ğŸ—‘ï¸ ìºì‹œ ì‚­ì œ</button>
        <button onclick="window.open('index.html')">ğŸš€ ë©”ì¸ ì•± ì—´ê¸°</button>
    </div>
    
    <div class="status">
        <h3>ë¡œê·¸</h3>
        <div id="log">ì´ˆê¸°í™” ì¤‘...\n</div>
    </div>

    <script>
        // ë¡œê·¸ í•¨ìˆ˜
        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? 'âŒ' : type === 'success' ? 'âœ…' : 'ğŸ“';
            logDiv.textContent += `[${timestamp}] ${prefix} ${message}\n`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(message);
        }

        // ë„¤íŠ¸ì›Œí¬ ìƒíƒœ í™•ì¸
        function checkNetwork() {
            const status = document.getElementById('networkStatus');
            if (navigator.onLine) {
                status.textContent = 'âœ… ì˜¨ë¼ì¸';
                status.className = 'success';
                log('ë„¤íŠ¸ì›Œí¬ ì—°ê²°: ì˜¨ë¼ì¸', 'success');
            } else {
                status.textContent = 'âŒ ì˜¤í”„ë¼ì¸';
                status.className = 'error';
                log('ë„¤íŠ¸ì›Œí¬ ì—°ê²°: ì˜¤í”„ë¼ì¸', 'error');
            }
        }

        // CDN í…ŒìŠ¤íŠ¸
        async function testCDN(url) {
            log(`CDN í…ŒìŠ¤íŠ¸ ì‹œì‘: ${url}`);
            const startTime = Date.now();
            
            try {
                const response = await fetch(url, { method: 'HEAD' });
                const elapsed = Date.now() - startTime;
                
                if (response.ok) {
                    log(`âœ… CDN ì‘ë‹µ ì„±ê³µ: ${elapsed}ms`, 'success');
                    alert(`âœ… ì„±ê³µ!\n${url}\nì‘ë‹µ ì‹œê°„: ${elapsed}ms`);
                } else {
                    log(`âŒ CDN ì‘ë‹µ ì‹¤íŒ¨: ${response.status}`, 'error');
                    alert(`âŒ ì‹¤íŒ¨!\nìƒíƒœ ì½”ë“œ: ${response.status}`);
                }
            } catch (error) {
                log(`âŒ CDN ì—°ê²° ì‹¤íŒ¨: ${error.message}`, 'error');
                alert(`âŒ ì—°ê²° ì‹¤íŒ¨!\n${error.message}`);
            }
        }

        // ìºì‹œ ì‚­ì œ
        function clearCache() {
            if (confirm('ë¸Œë¼ìš°ì € ìºì‹œë¥¼ ì‚­ì œí•˜ê³  í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // Service Worker ìºì‹œ ì‚­ì œ
                if ('caches' in window) {
                    caches.keys().then(names => {
                        names.forEach(name => {
                            caches.delete(name);
                        });
                    });
                }
                log('ìºì‹œ ì‚­ì œ ì™„ë£Œ', 'success');
                location.reload(true);
            }
        }

        // Three.js ë¡œë”©
        log('Three.js ë¡œë”© ì‹œì‘...');
        const threeScript = document.createElement('script');
        threeScript.src = 'https://cdn.jsdelivr.net/npm/three@0.150.1/build/three.min.js';
        threeScript.onload = function() {
            document.getElementById('threeStatus').textContent = 'âœ… Three.js: ë¡œë“œ ì™„ë£Œ';
            document.getElementById('threeStatus').className = 'success';
            log(`Three.js ë¡œë“œ ì™„ë£Œ (ë²„ì „: ${window.THREE?.REVISION || 'ì•Œ ìˆ˜ ì—†ìŒ'})`, 'success');
            
            // Three-DXF ë¡œë”©
            loadThreeDxf();
        };
        threeScript.onerror = function() {
            document.getElementById('threeStatus').textContent = 'âŒ Three.js: ë¡œë“œ ì‹¤íŒ¨';
            document.getElementById('threeStatus').className = 'error';
            log('Three.js ë¡œë“œ ì‹¤íŒ¨ - CDN ì°¨ë‹¨ ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ', 'error');
        };
        document.head.appendChild(threeScript);

        // Three-DXF ë¡œë”©
        function loadThreeDxf() {
            log('Three-DXF ë¡œë”© ì‹œì‘...');
            const dxfScript = document.createElement('script');
            dxfScript.src = 'https://cdn.jsdelivr.net/npm/three-dxf@3.3.2/dist/three-dxf.umd.js';
            dxfScript.onload = function() {
                document.getElementById('dxfStatus').textContent = 'âœ… Three-DXF: ë¡œë“œ ì™„ë£Œ';
                document.getElementById('dxfStatus').className = 'success';
                log('Three-DXF ë¡œë“œ ì™„ë£Œ', 'success');
                
                // ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì™„ë£Œ
                log('ğŸ‰ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© ì™„ë£Œ!', 'success');
                alert('âœ… ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì •ìƒì ìœ¼ë¡œ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!\në©”ì¸ ì•±(index.html)ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
            };
            dxfScript.onerror = function() {
                document.getElementById('dxfStatus').textContent = 'âŒ Three-DXF: ë¡œë“œ ì‹¤íŒ¨';
                document.getElementById('dxfStatus').className = 'error';
                log('Three-DXF ë¡œë“œ ì‹¤íŒ¨ - CDN ì°¨ë‹¨ ë˜ëŠ” ë„¤íŠ¸ì›Œí¬ ë¬¸ì œ', 'error');
            };
            document.head.appendChild(dxfScript);
        }

        // ì´ˆê¸°í™”
        checkNetwork();
        window.addEventListener('online', checkNetwork);
        window.addEventListener('offline', checkNetwork);

        log('í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ì´ˆê¸°í™” ì™„ë£Œ');
    </script>
</body>
</html>

